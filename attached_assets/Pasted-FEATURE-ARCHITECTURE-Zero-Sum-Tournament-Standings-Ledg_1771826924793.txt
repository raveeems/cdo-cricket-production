FEATURE ARCHITECTURE: Zero-Sum Tournament Standings Ledger

Context: We are introducing a "Winner Takes All" point system that spans across specific series/tournaments (e.g., T20 World Cup).

Database & Schema Updates:

Update the Match model/table to include:

tournamentName (String, nullable)

entryStake (Number, default: 30)

potProcessed (Boolean, default: false)

Create a new TournamentLedger table to act as a transactional history to prevent double-counting:

Fields: userId, userName, matchId, tournamentName, pointsChange (Number).

Admin Controls:

In the Admin Panel (Match edit/view), add an input for tournamentName (free text to group matches).

Add an input for entryStake (default 30). Constraint: Lock/disable this input if the match status is LIVE or COMPLETED.

Add a manual "Process Tournament Pot" button for COMPLETED matches.

The Math Engine (Zero-Sum Logic):
When "Process Tournament Pot" is clicked (or triggered post-match):

Threshold Check: Count total participating teams for the match. If < 2, abort and log "Not enough players". Check if potProcessed == true. If yes, abort to prevent duplicate math.

Identify Ranks: Find the team(s) with the highest fantasy points (Rank #1). These are the Winners. All other teams are Losers.

Calculate Points:

Loser Points = -entryStake

Winner Points = (Total Losers * entryStake) / Number of Winning Teams

Execute Ledger: Write a row to the TournamentLedger for every participating team with their respective pointsChange. If a user entered 2 losing teams, they get two -entryStake rows.

Lock: Set match potProcessed = true.

Frontend Leaderboard (Tournament Standings):

Create a new UI section/tab called "Tournament Standings".

Include a Dropdown populated by distinct tournamentNames from the ledger.

When a tournament is selected, aggregate the TournamentLedger for that specific tournamentName. Sum the pointsChange by userId.

Display a leaderboard sorted by highest total points to lowest (can include negative totals).